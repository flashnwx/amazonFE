{"ast":null,"code":"import { watch, onBeforeUnmount, onDeactivated } from \"vue\";\nimport { getScrollParent, onMountedOrActivated } from \"@vant/use\";\nimport { useTouch } from \"./use-touch.mjs\";\nimport { preventDefault } from \"../utils/index.mjs\";\nlet totalLockCount = 0;\nconst BODY_LOCK_CLASS = \"van-overflow-hidden\";\n\nfunction useLockScroll(rootRef, shouldLock) {\n  const touch = useTouch();\n  const DIRECTION_UP = \"01\";\n  const DIRECTION_DOWN = \"10\";\n\n  const onTouchMove = event => {\n    touch.move(event);\n    const direction = touch.deltaY.value > 0 ? DIRECTION_DOWN : DIRECTION_UP;\n    const el = getScrollParent(event.target, rootRef.value);\n    const {\n      scrollHeight,\n      offsetHeight,\n      scrollTop\n    } = el;\n    let status = \"11\";\n\n    if (scrollTop === 0) {\n      status = offsetHeight >= scrollHeight ? \"00\" : \"01\";\n    } else if (scrollTop + offsetHeight >= scrollHeight) {\n      status = \"10\";\n    }\n\n    if (status !== \"11\" && touch.isVertical() && !(parseInt(status, 2) & parseInt(direction, 2))) {\n      preventDefault(event, true);\n    }\n  };\n\n  const lock = () => {\n    document.addEventListener(\"touchstart\", touch.start);\n    document.addEventListener(\"touchmove\", onTouchMove, {\n      passive: false\n    });\n\n    if (!totalLockCount) {\n      document.body.classList.add(BODY_LOCK_CLASS);\n    }\n\n    totalLockCount++;\n  };\n\n  const unlock = () => {\n    if (totalLockCount) {\n      document.removeEventListener(\"touchstart\", touch.start);\n      document.removeEventListener(\"touchmove\", onTouchMove);\n      totalLockCount--;\n\n      if (!totalLockCount) {\n        document.body.classList.remove(BODY_LOCK_CLASS);\n      }\n    }\n  };\n\n  const init = () => shouldLock() && lock();\n\n  const destroy = () => shouldLock() && unlock();\n\n  onMountedOrActivated(init);\n  onDeactivated(destroy);\n  onBeforeUnmount(destroy);\n  watch(shouldLock, value => {\n    value ? lock() : unlock();\n  });\n}\n\nexport { useLockScroll };","map":{"version":3,"names":["watch","onBeforeUnmount","onDeactivated","getScrollParent","onMountedOrActivated","useTouch","preventDefault","totalLockCount","BODY_LOCK_CLASS","useLockScroll","rootRef","shouldLock","touch","DIRECTION_UP","DIRECTION_DOWN","onTouchMove","event","move","direction","deltaY","value","el","target","scrollHeight","offsetHeight","scrollTop","status","isVertical","parseInt","lock","document","addEventListener","start","passive","body","classList","add","unlock","removeEventListener","remove","init","destroy"],"sources":["/Users/niweixing/Downloads/web-code/node_modules/vant/es/composables/use-lock-scroll.mjs"],"sourcesContent":["import { watch, onBeforeUnmount, onDeactivated } from \"vue\";\nimport { getScrollParent, onMountedOrActivated } from \"@vant/use\";\nimport { useTouch } from \"./use-touch.mjs\";\nimport { preventDefault } from \"../utils/index.mjs\";\nlet totalLockCount = 0;\nconst BODY_LOCK_CLASS = \"van-overflow-hidden\";\nfunction useLockScroll(rootRef, shouldLock) {\n  const touch = useTouch();\n  const DIRECTION_UP = \"01\";\n  const DIRECTION_DOWN = \"10\";\n  const onTouchMove = (event) => {\n    touch.move(event);\n    const direction = touch.deltaY.value > 0 ? DIRECTION_DOWN : DIRECTION_UP;\n    const el = getScrollParent(\n      event.target,\n      rootRef.value\n    );\n    const { scrollHeight, offsetHeight, scrollTop } = el;\n    let status = \"11\";\n    if (scrollTop === 0) {\n      status = offsetHeight >= scrollHeight ? \"00\" : \"01\";\n    } else if (scrollTop + offsetHeight >= scrollHeight) {\n      status = \"10\";\n    }\n    if (status !== \"11\" && touch.isVertical() && !(parseInt(status, 2) & parseInt(direction, 2))) {\n      preventDefault(event, true);\n    }\n  };\n  const lock = () => {\n    document.addEventListener(\"touchstart\", touch.start);\n    document.addEventListener(\"touchmove\", onTouchMove, { passive: false });\n    if (!totalLockCount) {\n      document.body.classList.add(BODY_LOCK_CLASS);\n    }\n    totalLockCount++;\n  };\n  const unlock = () => {\n    if (totalLockCount) {\n      document.removeEventListener(\"touchstart\", touch.start);\n      document.removeEventListener(\"touchmove\", onTouchMove);\n      totalLockCount--;\n      if (!totalLockCount) {\n        document.body.classList.remove(BODY_LOCK_CLASS);\n      }\n    }\n  };\n  const init = () => shouldLock() && lock();\n  const destroy = () => shouldLock() && unlock();\n  onMountedOrActivated(init);\n  onDeactivated(destroy);\n  onBeforeUnmount(destroy);\n  watch(shouldLock, (value) => {\n    value ? lock() : unlock();\n  });\n}\nexport {\n  useLockScroll\n};\n"],"mappings":"AAAA,SAASA,KAAT,EAAgBC,eAAhB,EAAiCC,aAAjC,QAAsD,KAAtD;AACA,SAASC,eAAT,EAA0BC,oBAA1B,QAAsD,WAAtD;AACA,SAASC,QAAT,QAAyB,iBAAzB;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,IAAIC,cAAc,GAAG,CAArB;AACA,MAAMC,eAAe,GAAG,qBAAxB;;AACA,SAASC,aAAT,CAAuBC,OAAvB,EAAgCC,UAAhC,EAA4C;EAC1C,MAAMC,KAAK,GAAGP,QAAQ,EAAtB;EACA,MAAMQ,YAAY,GAAG,IAArB;EACA,MAAMC,cAAc,GAAG,IAAvB;;EACA,MAAMC,WAAW,GAAIC,KAAD,IAAW;IAC7BJ,KAAK,CAACK,IAAN,CAAWD,KAAX;IACA,MAAME,SAAS,GAAGN,KAAK,CAACO,MAAN,CAAaC,KAAb,GAAqB,CAArB,GAAyBN,cAAzB,GAA0CD,YAA5D;IACA,MAAMQ,EAAE,GAAGlB,eAAe,CACxBa,KAAK,CAACM,MADkB,EAExBZ,OAAO,CAACU,KAFgB,CAA1B;IAIA,MAAM;MAAEG,YAAF;MAAgBC,YAAhB;MAA8BC;IAA9B,IAA4CJ,EAAlD;IACA,IAAIK,MAAM,GAAG,IAAb;;IACA,IAAID,SAAS,KAAK,CAAlB,EAAqB;MACnBC,MAAM,GAAGF,YAAY,IAAID,YAAhB,GAA+B,IAA/B,GAAsC,IAA/C;IACD,CAFD,MAEO,IAAIE,SAAS,GAAGD,YAAZ,IAA4BD,YAAhC,EAA8C;MACnDG,MAAM,GAAG,IAAT;IACD;;IACD,IAAIA,MAAM,KAAK,IAAX,IAAmBd,KAAK,CAACe,UAAN,EAAnB,IAAyC,EAAEC,QAAQ,CAACF,MAAD,EAAS,CAAT,CAAR,GAAsBE,QAAQ,CAACV,SAAD,EAAY,CAAZ,CAAhC,CAA7C,EAA8F;MAC5FZ,cAAc,CAACU,KAAD,EAAQ,IAAR,CAAd;IACD;EACF,CAjBD;;EAkBA,MAAMa,IAAI,GAAG,MAAM;IACjBC,QAAQ,CAACC,gBAAT,CAA0B,YAA1B,EAAwCnB,KAAK,CAACoB,KAA9C;IACAF,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,EAAuChB,WAAvC,EAAoD;MAAEkB,OAAO,EAAE;IAAX,CAApD;;IACA,IAAI,CAAC1B,cAAL,EAAqB;MACnBuB,QAAQ,CAACI,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B5B,eAA5B;IACD;;IACDD,cAAc;EACf,CAPD;;EAQA,MAAM8B,MAAM,GAAG,MAAM;IACnB,IAAI9B,cAAJ,EAAoB;MAClBuB,QAAQ,CAACQ,mBAAT,CAA6B,YAA7B,EAA2C1B,KAAK,CAACoB,KAAjD;MACAF,QAAQ,CAACQ,mBAAT,CAA6B,WAA7B,EAA0CvB,WAA1C;MACAR,cAAc;;MACd,IAAI,CAACA,cAAL,EAAqB;QACnBuB,QAAQ,CAACI,IAAT,CAAcC,SAAd,CAAwBI,MAAxB,CAA+B/B,eAA/B;MACD;IACF;EACF,CATD;;EAUA,MAAMgC,IAAI,GAAG,MAAM7B,UAAU,MAAMkB,IAAI,EAAvC;;EACA,MAAMY,OAAO,GAAG,MAAM9B,UAAU,MAAM0B,MAAM,EAA5C;;EACAjC,oBAAoB,CAACoC,IAAD,CAApB;EACAtC,aAAa,CAACuC,OAAD,CAAb;EACAxC,eAAe,CAACwC,OAAD,CAAf;EACAzC,KAAK,CAACW,UAAD,EAAcS,KAAD,IAAW;IAC3BA,KAAK,GAAGS,IAAI,EAAP,GAAYQ,MAAM,EAAvB;EACD,CAFI,CAAL;AAGD;;AACD,SACE5B,aADF"},"metadata":{},"sourceType":"module"}